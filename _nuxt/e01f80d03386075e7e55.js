(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{328:function(e,t,n){var content=n(338);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(16).default)("5ed9bf8d",content,!0,{sourceMap:!1})},337:function(e,t,n){"use strict";var r=n(328);n.n(r).a},338:function(e,t,n){(t=n(15)(!1)).push([e.i,"#chatContainer{overflow:scroll;height:auto}",""]),e.exports=t},378:function(e,t,n){"use strict";n.r(t);n(59),n(60),n(8),n(50);var r=n(17),o=n(331),main=n(332),c=n.n(main),l=n(107),m=n.n(l),d=void 0;function v(){var data=Object(o.a)(["\n        query messages {\n          messages {\n            id\n            body\n            timer\n            time\n            user {\n              id\n              displayName\n              username\n            }\n          }\n        }\n      "]);return v=function(){return data},data}function h(){var data=Object(o.a)(["\n        query me {\n          me {\n            id\n            username\n            displayName\n            ip\n            agent\n            online\n            lastSeen\n            lastTyped\n          }\n        }\n      "]);return h=function(){return data},data}function f(){var data=Object(o.a)(["\n          mutation sendMessage($body: String!, $timer: String) {\n            sendMessage(body: $body, timer: $timer) {\n              id\n              body\n              timer\n              time\n            }\n          }\n        "]);return f=function(){return data},data}function k(){var data=Object(o.a)(["\n        mutation updateLastSeen {\n          updateLastSeen {\n            id\n            username\n            ip\n            agent\n            online\n            lastSeen\n            lastTyped\n          }\n        }\n      "]);return k=function(){return data},data}function y(){var data=Object(o.a)(["\n  subscription newMessage {\n    newMessage {\n      id\n      body\n      time\n      timer\n      user {\n        id\n        username\n        displayName\n      }\n    }\n  }\n"]);return y=function(){return data},data}var x=m()(y()),_={components:{EmojiPicker:c.a},data:function(){return{show:!1,message:"",messages:[],marker:!0,timer:"0",sTimer:!1,iconIndex:0,icons:["mdi-emoticon","mdi-emoticon-cool","mdi-emoticon-dead","mdi-emoticon-excited","mdi-emoticon-happy","mdi-emoticon-neutral","mdi-emoticon-sad","mdi-emoticon-tongue"],input:"",search:"",isAuthenticated:!1,typing:!0,pageHeight:null,me:null}},computed:{icon:function(){return this.icons[this.iconIndex]}},mounted:function(){this.isAuthenticated=!!this.$apolloHelpers.getToken(),this.isAuthenticated?this.getMe():this.$router.push({name:"index"}),this.getMessages(),this.pageHeight=document.getElementById("content").clientHeight,this.scrollToEnd()},apollo:{$subscribe:{messages:{query:x,result:function(data){this.messages.push(data.data.newMessage),this.scrollToEnd()}}}},methods:{getTime:function(e){var t=new Date(1e3*e);return t.getHours()+":"+("0"+t.getMinutes()).substr(-2)},setTimer:function(e){this.timer=e},updateLastSeen:function(){d.isAuthenticated=!!d.$apolloHelpers.getToken();var e=m()(k());setInterval(Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$apollo.mutate({mutation:e,context:{headers:{token:this.$apolloHelpers.getToken(),"Cache-Control":"no-cache"}}}).then();case 3:t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))).bind(d),2e3)},scrollToEnd:function(){setTimeout((function(){var e=document.getElementById("chatContainer");e.scrollTop=e.scrollHeight+1e4}),100)},insert:function(e){this.message+=e},toggleMarker:function(){this.marker=!this.marker},sendMessage:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,body,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.me){t.next=15;break}return e.resetIcon(),n=m()(f()),body=e.message,e.clearMessage(),r=e.timer.toString(),t.prev=6,t.next=9,e.$apollo.mutate({mutation:n,context:{headers:{token:e.$apolloHelpers.getToken(),"Cache-Control":"no-cache"}},variables:{body:body,timer:r}}).then((function(e){return e.data}));case 9:t.sent,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(6),console.error(t.t0);case 15:e.clearMessage(),e.scrollToEnd();case 17:case"end":return t.stop()}}),t,null,[[6,12]])})))()},clearMessage:function(){this.message=""},resetIcon:function(){this.iconIndex=0},changeIcon:function(){this.iconIndex===this.icons.length-1?this.iconIndex=0:this.iconIndex++,this.$refs.myBtn.click()},showTimer:function(){this.sTimer=!this.sTimer},getMe:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=m()(h()),t.prev=1,t.next=4,e.$apollo.query({query:n,context:{headers:{token:e.$apolloHelpers.getToken(),"Cache-Control":"no-cache"}}}).then();case 4:(r=t.sent)&&(e.me=r.data.me),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},getMessages:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=m()(v()),t.prev=1,t.next=4,e.$apollo.query({query:n,context:{headers:{token:e.$apolloHelpers.getToken(),"Cache-Control":"no-cache"}}}).then();case 4:r=t.sent,e.messages=r.data.messages,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()}}},T=(n(337),n(61)),w=n(87),C=n.n(w),M=n(134),j=n(333),$=n(326),I=n(370),S=n(371),V=n(131),H=n(346),O=n(132),N=n(79),R=n(54),E=n(377),L=n(372),A=n(373),B=n(374),P=n(375),component=Object(T.a)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-layout",{attrs:{id:"chat-main",column:""}},[n("v-container",{attrs:{absolute:""}},[n("div",{style:{"max-height":"calc("+(e.pageHeight-150)+"px)"},attrs:{id:"chatContainer"}},e._l(e.messages,(function(t){return n("v-timeline",{key:e.messages.id,attrs:{"align-top":!0,reverse:t.user.id===e.me.id,dense:!0}},[new Date>Number(t.time)+Number(t.timer)?n("v-timeline-item",{scopedSlots:e._u([{key:"icon",fn:function(){return[n("v-avatar",[n("img",{attrs:{src:"https://i.pravatar.cc/64?u="+t.user.id,alt:"avater"}})]),e._v(" "),n("div",{staticClass:"chat-username"},[t.user.id!==e.me.id?n("p",{staticStyle:{margin:"15px"}},[e._v("\n                "+e._s(t.user.displayName)+"\n              ")]):e._e()])]},proxy:!0}],null,!0)},[e._v(" "),n("v-card",{staticClass:"elevation-2",attrs:{loading:0!==Number(t.timer)}},[n("v-card-text",[e._v("\n              "+e._s(t.body)+"\n              "),n("span",{staticStyle:{"font-size":"xx-small",float:"right"}},[0!==Number(t.timer)?n("v-icon",{staticStyle:{"font-size":"xx-small"}},[e._v("mdi-alarm")]):e._e(),e._v("\n                "+e._s(e.getTime(t.time)))],1)])],1)],1):e._e()],1)})),1)]),e._v(" "),n("v-row",[n("v-col",{staticClass:"chat-input",attrs:{cols:"12"}},[n("emoji-picker",{attrs:{search:e.search},on:{emoji:e.insert},scopedSlots:e._u([{key:"emoji-invoker",fn:function(t){var r=t.events.click;return n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"myBtn",on:{click:function(e){return e.stopPropagation(),r(e)}}},[n("button",{attrs:{type:"button"}},[e._v("open")])])}},{key:"emoji-picker",fn:function(t){var r=t.emojis;return n("div",{},[n("div",{staticClass:"emoji-picker"},[n("div",{staticClass:"emoji-picker__search"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.search,expression:"search"}],attrs:{type:"text"},domProps:{value:e.search},on:{input:function(t){t.target.composing||(e.search=t.target.value)}}})]),e._v(" "),n("div",e._l(r,(function(t,r){return n("div",{key:r},[n("h5",[e._v(e._s(r))]),e._v(" "),n("div",{staticClass:"emojis"},e._l(t,(function(t,r){return n("span",{key:r,attrs:{title:r},on:{click:function(n){return e.insert(t)}}},[e._v(e._s(t))])})),0)])})),0)])])}}])}),e._v(" "),n("v-textarea",{attrs:{"append-icon":e.marker?"mdi-attachment":"mdi-paperclip","append-outer-icon":e.message?"mdi-send":"mdi-microphone","prepend-inner-icon":e.sTimer?"mdi-alarm-note-off":"mdi-alarm","prepend-icon":e.icon,"auto-grow":!0,rows:1,filled:"","clear-icon":"mdi-close-circle",clearable:"",type:"text",placeholder:"Type a message...",outlined:"",autofocus:""},on:{"click:append":e.toggleMarker,"click:append-outer":e.sendMessage,"click:prepend":e.changeIcon,"click:prepend-inner":e.showTimer,"click:clear":e.clearMessage},scopedSlots:e._u([{key:"prepend-inner",fn:function(){return[n("v-menu",{attrs:{"open-on-hover":!1,"close-on-click":!0,"close-on-content-click":!0,dark:"",absolute:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on;return[n("v-icon",e._g({},r),[e._v(e._s(e.timer?"mdi-alarm":"mdi-alarm-note-off"))])]}}])},[e._v(" "),n("v-list",[n("v-list-item",{on:{click:function(t){return e.setTimer(0)}}},[n("v-list-item-title",[e._v("Off")])],1),e._v(" "),n("v-list-item",{on:{click:function(t){return e.setTimer(1)}}},[n("v-list-item-title",[e._v("1 second")])],1),e._v(" "),n("v-list-item",{on:{click:function(t){return e.setTimer(60)}}},[n("v-list-item-title",[e._v("1 minute")])],1),e._v(" "),n("v-list-item",{on:{click:function(t){return e.setTimer(3600)}}},[n("v-list-item-title",[e._v("1 hour")])],1),e._v(" "),n("v-list-item",{on:{click:function(t){return e.setTimer(86400)}}},[n("v-list-item-title",[e._v("1 day")])],1)],1)],1)]},proxy:!0}]),model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;C()(component,{VAvatar:M.a,VCard:j.a,VCardText:$.a,VCol:I.a,VContainer:S.a,VIcon:V.a,VLayout:H.a,VList:O.a,VListItem:N.a,VListItemTitle:R.b,VMenu:E.a,VRow:L.a,VTextarea:A.a,VTimeline:B.a,VTimelineItem:P.a})}}]);